<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dinner Party Planner - Ultimate Edition</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --navy: #1e3a5f;
      --navy-dark: #152a45;
      --gold: #c9a227;
      --cream: #faf8f5;
      --text: #2d3a35;
      --text-light: #6b7c85;
      --green: #2d6a4f;
    }
    body { min-height: 100vh; background: var(--cream); font-family: 'Crimson Text', Georgia, serif; color: var(--text); line-height: 1.6; }
    .header { background: linear-gradient(135deg, var(--navy) 0%, var(--navy-dark) 100%); padding: 2rem 1rem 3rem; text-align: center; color: white; }
    .header-icon { width: 50px; height: 50px; margin: 0 auto 0.75rem; background: rgba(255,255,255,0.15); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
    .header h1 { font-family: 'Playfair Display', Georgia, serif; font-size: 2rem; font-weight: 600; margin-bottom: 0.5rem; }
    .header p { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.2em; opacity: 0.7; }
    .container { max-width: 720px; margin: -2rem auto 2rem; padding: 0 1rem; }
    .progress { display: flex; justify-content: center; align-items: center; gap: 0; margin-bottom: 1.5rem; padding: 1.5rem; background: white; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); }
    .progress-step { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem; background: white; border: 2px solid #d0d5dd; color: #d0d5dd; transition: all 0.3s ease; }
    .progress-step.active { background: var(--navy); border-color: var(--navy); color: white; }
    .progress-step.complete { background: var(--navy); border-color: var(--navy); color: white; }
    .progress-line { width: 40px; height: 2px; background: #d0d5dd; }
    .progress-line.complete { background: var(--navy); }
    .card { background: white; border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
    .card-title { font-family: 'Playfair Display', Georgia, serif; font-size: 1.35rem; font-weight: 600; color: var(--navy); margin-bottom: 0.25rem; }
    .card-subtitle { font-size: 0.9rem; color: var(--text-light); margin-bottom: 1.25rem; }
    label { display: block; font-weight: 600; font-size: 0.9rem; margin-bottom: 0.5rem; color: var(--text); }
    input[type="text"], input[type="date"], input[type="time"], input[type="number"], textarea, select {
      width: 100%; padding: 0.75rem 1rem; border: 1px solid #d0d5dd; border-radius: 8px;
      font-family: 'Crimson Text', Georgia, serif; font-size: 1rem; color: var(--text); background: white;
    }
    input:focus, textarea:focus, select:focus { outline: none; border-color: var(--navy); }
    textarea { min-height: 100px; resize: vertical; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
    .form-group { margin-bottom: 1rem; }
    .style-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; margin-top: 1rem; }
    .style-card { border: 2px solid #e8e8e8; border-radius: 8px; overflow: hidden; cursor: pointer; transition: all 0.2s; }
    .style-card:hover { border-color: var(--navy); }
    .style-card.selected { border-color: var(--navy); box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.2); }
    .style-preview { aspect-ratio: 3/4; padding: 0.5rem; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; font-size: 0.6rem; }
    .style-preview.classic { background: var(--navy); color: #c9a227; }
    .style-preview.modern { background: white; color: #333; border-bottom: 1px solid #eee; }
    .style-preview.romantic { background: #fdf2f4; color: #8b5a6b; }
    .style-preview.artdeco { background: #1a1a2e; color: #d4af37; }
    .style-preview.rustic { background: #f5f0e8; color: #5d4e37; }
    .style-preview.botanical { background: #f0f7f4; color: #2d5a47; }
    .style-preview.coastal { background: #e8f4f8; color: #2e6171; }
    .style-preview.urban { background: #1a1a1a; color: #ffffff; }
    .style-name { text-align: center; padding: 0.5rem; font-size: 0.75rem; font-weight: 600; }
    .inspiration-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.75rem; }
    .inspiration-card { background: white; border: 2px solid #e8e8e8; border-radius: 12px; padding: 1rem 0.75rem; text-align: center; cursor: pointer; transition: all 0.2s; }
    .inspiration-card:hover { border-color: var(--navy); transform: translateY(-2px); }
    .inspiration-card.selected { border-color: var(--navy); background: #f8fafc; }
    .inspiration-icon { font-size: 1.75rem; margin-bottom: 0.5rem; }
    .inspiration-title { font-weight: 600; font-size: 0.85rem; color: var(--navy); margin-bottom: 0.25rem; }
    .inspiration-desc { font-size: 0.7rem; color: var(--text-light); }
    .option-group { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem; }
    .option-btn { padding: 0.625rem 1rem; border: 1px solid #d0d5dd; border-radius: 25px; background: white; cursor: pointer; font-family: 'Crimson Text', Georgia, serif; font-size: 0.9rem; color: var(--text); transition: all 0.2s; }
    .option-btn:hover { border-color: var(--navy); }
    .option-btn.selected { background: var(--navy); border-color: var(--navy); color: white; }
    .tag-group { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .tag { padding: 0.5rem 0.875rem; border: 1px solid #d0d5dd; border-radius: 6px; background: white; cursor: pointer; font-size: 0.85rem; transition: all 0.2s; }
    .tag:hover { border-color: var(--navy); }
    .tag.selected { background: var(--navy); border-color: var(--navy); color: white; }
    .tag.small { padding: 0.375rem 0.625rem; font-size: 0.8rem; }
    .sub-options { margin-top: 1rem; animation: slideDown 0.3s ease; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .sub-section { background: #f8fafc; border: 1px solid #e2e8f0; border-left: 3px solid var(--navy); border-radius: 0 8px 8px 0; padding: 1rem 1.25rem; }
    .sub-label { font-family: 'Playfair Display', Georgia, serif; font-weight: 600; font-size: 0.95rem; color: var(--navy); margin-bottom: 0.75rem; }
    .sub-group-label { font-size: 0.75rem; font-weight: 600; color: var(--text-light); margin-top: 0.75rem; margin-bottom: 0.375rem; }
    .menu-option { border: 1px solid #e8e8e8; border-radius: 12px; padding: 1.25rem; margin-bottom: 1rem; cursor: pointer; transition: all 0.2s; }
    .menu-option:hover { border-color: var(--navy); }
    .menu-option.selected { border-color: var(--navy); border-width: 2px; background: #f8fafc; }
    .menu-option h3 { font-family: 'Playfair Display', Georgia, serif; font-size: 1.1rem; font-weight: 600; color: var(--navy); margin-bottom: 0.25rem; }
    .menu-option .estimate { font-size: 0.85rem; color: var(--green); font-weight: 600; margin-bottom: 0.75rem; }
    .menu-option .course { font-size: 0.9rem; margin-bottom: 0.375rem; padding-left: 0.5rem; }
    .menu-option .course::before { content: "‚Ä¢"; margin-right: 0.5rem; color: var(--gold); }
    .staffing-card { border: 2px solid #e8e8e8; border-radius: 12px; padding: 1.25rem; margin-bottom: 1rem; transition: all 0.2s; }
    .staffing-card.selected { border-color: var(--gold); background: linear-gradient(135deg, #fdf8e8 0%, #faf3d8 100%); }
    .staffing-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem; }
    .staffing-info { display: flex; align-items: center; gap: 0.75rem; }
    .staffing-icon { font-size: 2rem; }
    .staffing-name { font-family: 'Playfair Display', Georgia, serif; font-weight: 600; font-size: 1.1rem; color: var(--navy); }
    .staffing-desc { font-size: 0.85rem; color: var(--text-light); }
    .staffing-stats { text-align: right; }
    .staffing-stats strong { display: block; font-size: 1rem; color: var(--navy); }
    .staffing-buttons { display: flex; gap: 0.5rem; }
    .staffing-btn { flex: 1; padding: 0.625rem 1rem; border-radius: 6px; border: 1px solid #d0d5dd; background: white; cursor: pointer; font-family: 'Crimson Text', Georgia, serif; font-size: 0.9rem; font-weight: 600; transition: all 0.2s; }
    .staffing-btn.view { background: #f0f4f8; color: var(--navy); }
    .staffing-btn.select { background: var(--navy); color: white; border-color: var(--navy); }
    .staffing-btn.selected { background: var(--gold); border-color: var(--gold); color: var(--navy-dark); }
    .download-header { text-align: center; padding: 2rem 1rem; background: linear-gradient(135deg, #f0f4f8 0%, #e8eff5 100%); border-radius: 12px; margin-bottom: 1.5rem; }
    .download-header .icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
    .download-header h2 { font-family: 'Playfair Display', Georgia, serif; font-size: 1.5rem; color: var(--navy); }
    .download-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-bottom: 0.75rem; }
    .download-btn { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 1.25rem 1rem; background: white; border: 1px solid #d0d5dd; border-radius: 10px; cursor: pointer; font-family: 'Crimson Text', Georgia, serif; transition: all 0.2s; }
    .download-btn:hover { border-color: var(--navy); background: #f8fafc; }
    .download-btn .icon { font-size: 1.5rem; }
    .download-btn span { font-size: 0.85rem; color: var(--text); text-align: center; }
    .btn-row { display: flex; gap: 0.75rem; margin-top: 1.5rem; }
    .btn { padding: 0.875rem 1.5rem; border-radius: 8px; border: none; font-family: 'Crimson Text', Georgia, serif; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .btn-secondary { background: white; color: var(--text); border: 1px solid #d0d5dd; }
    .btn-primary { background: var(--navy); color: white; }
    .btn-primary:disabled { background: #a0aec0; cursor: not-allowed; }
    .info-box { background: #f8f5f0; border: 1px solid #e8e0d4; border-radius: 8px; padding: 0.875rem 1rem; font-size: 0.9rem; color: var(--text-light); margin-bottom: 1rem; }
    .hidden { display: none !important; }
    .settings-panel { margin-bottom: 1rem; }
    .settings-toggle { width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 1rem; background: white; border: 1px solid #d0d5dd; border-radius: 8px; cursor: pointer; font-family: 'Crimson Text', Georgia, serif; font-size: 0.95rem; }
    .settings-content { margin-top: 0.5rem; }
    .settings-inner { background: white; border: 1px solid #d0d5dd; border-radius: 8px; padding: 1.25rem; }
    .api-status { margin-top: 1rem; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem; display: none; }
    .api-status.success { display: block; background: #ecfdf5; color: #065f46; border: 1px solid #a7f3d0; }
    .api-status.error { display: block; background: #fef2f2; color: #991b1b; border: 1px solid #fecaca; }
    @media (max-width: 600px) {
      .style-grid, .inspiration-grid { grid-template-columns: repeat(2, 1fr); }
      .download-grid { grid-template-columns: repeat(2, 1fr); }
      .form-row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-icon">üçΩÔ∏è</div>
    <h1>Dinner Party Planner</h1>
    <p>Ultimate Edition ‚Ä¢ AI-Powered Professional Cookbook Generation</p>
  </header>

  <div class="container">
    <!-- Settings Panel -->
    <div class="settings-panel">
      <button class="settings-toggle" onclick="toggleSettings()">
        <span>‚öôÔ∏è Settings</span>
        <span id="settingsArrow">‚ñº</span>
      </button>
      <div class="settings-content hidden" id="settingsContent">
        <div class="settings-inner">
          <div class="form-group">
            <label>üîë Access Code</label>
            <input type="text" id="accessCode" placeholder="Enter your beta access code">
          </div>
          <div class="btn-row"><button class="btn btn-primary" onclick="validateCode()">Validate Code</button></div>
          <div id="apiStatus" class="api-status"></div>
        </div>
      </div>
    </div>

    <!-- Progress Bar -->
    <div class="progress">
      <div class="progress-step active" id="pstep1">1</div>
      <div class="progress-line" id="pline1"></div>
      <div class="progress-step" id="pstep2">2</div>
      <div class="progress-line" id="pline2"></div>
      <div class="progress-step" id="pstep3">3</div>
      <div class="progress-line" id="pline3"></div>
      <div class="progress-step" id="pstep4">4</div>
      <div class="progress-line" id="pline4"></div>
      <div class="progress-step" id="pstep5">5</div>
      <div class="progress-line" id="pline5"></div>
      <div class="progress-step" id="pstep6">6</div>
    </div>

    <!-- STEP 1: Event Details -->
    <div id="step1">
      <div class="card">
        <h2 class="card-title">üìã Event Details</h2>
        <div class="form-group">
          <label>Event Title</label>
          <input type="text" id="eventTitle" placeholder="Anniversary Dinner, Birthday Celebration...">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Date</label>
            <input type="date" id="eventDate">
          </div>
          <div class="form-group">
            <label>Service Time</label>
            <input type="time" id="eventTime" value="19:00">
          </div>
        </div>
        <div class="form-group">
          <label>Number of Guests</label>
          <input type="number" id="guestCount" value="6" min="2" max="24">
        </div>
      </div>

      <div class="card">
        <h2 class="card-title">üë• Guest List</h2>
        <p class="card-subtitle">For personalized place cards</p>
        <textarea id="guestList" placeholder="Enter each guest on a new line:&#10;Mr. and Mrs. John Smith&#10;Dr. Jane Doe&#10;The Andersons"></textarea>
      </div>

      <div class="card">
        <h2 class="card-title">üé® Menu Style</h2>
        <p class="card-subtitle">Choose a visual style for your menu cards</p>
        <div class="style-grid">
          <div class="style-card selected" data-style="classic" onclick="selectStyle(this)">
            <div class="style-preview classic">Menu</div>
            <div class="style-name">Classic</div>
          </div>
          <div class="style-card" data-style="modern" onclick="selectStyle(this)">
            <div class="style-preview modern">Menu</div>
            <div class="style-name">Modern</div>
          </div>
          <div class="style-card" data-style="romantic" onclick="selectStyle(this)">
            <div class="style-preview romantic">Menu</div>
            <div class="style-name">Romantic</div>
          </div>
          <div class="style-card" data-style="artdeco" onclick="selectStyle(this)">
            <div class="style-preview artdeco">Menu</div>
            <div class="style-name">Art Deco</div>
          </div>
          <div class="style-card" data-style="rustic" onclick="selectStyle(this)">
            <div class="style-preview rustic">Menu</div>
            <div class="style-name">Rustic</div>
          </div>
          <div class="style-card" data-style="botanical" onclick="selectStyle(this)">
            <div class="style-preview botanical">Menu</div>
            <div class="style-name">Botanical</div>
          </div>
          <div class="style-card" data-style="coastal" onclick="selectStyle(this)">
            <div class="style-preview coastal">Menu</div>
            <div class="style-name">Coastal</div>
          </div>
          <div class="style-card" data-style="urban" onclick="selectStyle(this)">
            <div class="style-preview urban">Menu</div>
            <div class="style-name">Urban</div>
          </div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" disabled>‚Üê Back</button>
        <button class="btn btn-primary" onclick="goToStep(2)">Next: Inspiration ‚Üí</button>
      </div>
    </div>

    <!-- STEP 2: Menu Inspiration -->
    <div id="step2" class="hidden">
      <div class="card">
        <h2 class="card-title">üç≥ Menu Inspiration</h2>
        <p class="card-subtitle">What kind of dining experience do you want?</p>
        <div class="inspiration-grid">
          <div class="inspiration-card" data-inspiration="chefs" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üë®‚Äçüç≥</div>
            <div class="inspiration-title">Chef's Tasting</div>
            <div class="inspiration-desc">Elegant multi-course</div>
          </div>
          <div class="inspiration-card" data-inspiration="adventurous" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üåç</div>
            <div class="inspiration-title">Adventurous</div>
            <div class="inspiration-desc">Bold global flavors</div>
          </div>
          <div class="inspiration-card" data-inspiration="garden" onclick="selectInspiration(this)">
            <div class="inspiration-icon">ü•ó</div>
            <div class="inspiration-title">Garden to Table</div>
            <div class="inspiration-desc">Fresh, seasonal</div>
          </div>
          <div class="inspiration-card" data-inspiration="comfort" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üè†</div>
            <div class="inspiration-title">Comfort Food</div>
            <div class="inspiration-desc">Elevated classics</div>
          </div>
          <div class="inspiration-card" data-inspiration="seasonal" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üå±</div>
            <div class="inspiration-title">Seasonal</div>
            <div class="inspiration-desc">Peak freshness</div>
          </div>
          <div class="inspiration-card" data-inspiration="restaurant" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üçΩÔ∏è</div>
            <div class="inspiration-title">Restaurant Style</div>
            <div class="inspiration-desc">Recreate favorites</div>
          </div>
          <div class="inspiration-card" data-inspiration="michelin" onclick="selectInspiration(this)">
            <div class="inspiration-icon">‚≠ê</div>
            <div class="inspiration-title">Fine Dining</div>
            <div class="inspiration-desc">Michelin inspired</div>
          </div>
          <div class="inspiration-card" data-inspiration="holiday" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üéÑ</div>
            <div class="inspiration-title">Holiday</div>
            <div class="inspiration-desc">Festive traditions</div>
          </div>
          <div class="inspiration-card" data-inspiration="dietary" onclick="selectInspiration(this)">
            <div class="inspiration-icon">ü•¨</div>
            <div class="inspiration-title">Dietary Focus</div>
            <div class="inspiration-desc">Keto, vegan, etc</div>
          </div>
          <div class="inspiration-card" data-inspiration="budget" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üí∞</div>
            <div class="inspiration-title">Budget Smart</div>
            <div class="inspiration-desc">Elegant on a budget</div>
          </div>
          <div class="inspiration-card" data-inspiration="street" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üåÆ</div>
            <div class="inspiration-title">Street Food</div>
            <div class="inspiration-desc">Elevated street fare</div>
          </div>
          <div class="inspiration-card" data-inspiration="custom" onclick="selectInspiration(this)">
            <div class="inspiration-icon">üìù</div>
            <div class="inspiration-title">Custom</div>
            <div class="inspiration-desc">Your own idea</div>
          </div>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="goToStep(1)">‚Üê Back</button>
        <button class="btn btn-primary" onclick="goToStep(3)">Next: Preferences ‚Üí</button>
      </div>
    </div>

    <!-- STEP 3: Preferences -->
    <div id="step3" class="hidden">
      <div class="card">
        <h2 class="card-title">üí∞ Budget & Skill Level</h2>
        <label>Budget per Person</label>
        <div class="option-group">
          <button class="option-btn" data-value="budget" onclick="selectOption(this,'budget')">üíµ Budget $15-25</button>
          <button class="option-btn selected" data-value="moderate" onclick="selectOption(this,'budget')">üíµüíµ Moderate $30-50</button>
          <button class="option-btn" data-value="upscale" onclick="selectOption(this,'budget')">üíµüíµüíµ Upscale $60-100</button>
          <button class="option-btn" data-value="luxury" onclick="selectOption(this,'budget')">üíé Luxury $100+</button>
        </div>
        <label>Your Cooking Skill</label>
        <div class="option-group">
          <button class="option-btn" data-value="beginner" onclick="selectOption(this,'skill')">ü•Ñ Beginner</button>
          <button class="option-btn selected" data-value="intermediate" onclick="selectOption(this,'skill')">üç≥ Intermediate</button>
          <button class="option-btn" data-value="advanced" onclick="selectOption(this,'skill')">üë®‚Äçüç≥ Advanced</button>
        </div>
      </div>

      <div class="card">
        <h2 class="card-title">üç¥ Cuisine Preferences</h2>
        <p class="card-subtitle">Select all that interest you</p>
        <div class="tag-group" id="cuisineGroup">
          <button class="tag" onclick="toggleCuisine(this,'american')">American</button>
          <button class="tag" onclick="toggleCuisine(this,'european')">European</button>
          <button class="tag" onclick="toggleCuisine(this,'asian')">Asian</button>
          <button class="tag" onclick="toggleCuisine(this,'mexican')">Mexican</button>
          <button class="tag" onclick="toggleCuisine(this,'french')">French</button>
          <button class="tag" onclick="toggleCuisine(this,'italian')">Italian</button>
          <button class="tag" onclick="toggleCuisine(this,'mediterranean')">Mediterranean</button>
          <button class="tag" onclick="toggleCuisine(this,'middleeastern')">Middle Eastern</button>
          <button class="tag" onclick="toggleCuisine(this,'caribbean')">Caribbean</button>
          <button class="tag" onclick="toggleCuisine(this,'indian')">Indian</button>
          <button class="tag" onclick="toggleCuisine(this,'japanese')">Japanese</button>
        </div>

        <!-- American Sub-options -->
        <div id="american-sub" class="sub-options hidden">
          <div class="sub-section">
            <div class="sub-label">üá∫üá∏ American Regions</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Southern</button>
              <button class="tag small" onclick="toggleTag(this)">New England</button>
              <button class="tag small" onclick="toggleTag(this)">California</button>
              <button class="tag small" onclick="toggleTag(this)">Midwest</button>
              <button class="tag small" onclick="toggleTag(this)">Southwest</button>
              <button class="tag small" onclick="toggleTag(this)">BBQ</button>
              <button class="tag small" onclick="toggleTag(this)">Soul Food</button>
              <button class="tag small" onclick="toggleTag(this)">Cajun</button>
            </div>
          </div>
        </div>

        <!-- European Sub-options -->
        <div id="european-sub" class="sub-options hidden">
          <div class="sub-section">
            <div class="sub-label">üá™üá∫ European Regions</div>
            <div class="sub-group-label">France:</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Provence</button>
              <button class="tag small" onclick="toggleTag(this)">Burgundy</button>
              <button class="tag small" onclick="toggleTag(this)">Lyon</button>
            </div>
            <div class="sub-group-label">Italy:</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Tuscany</button>
              <button class="tag small" onclick="toggleTag(this)">Sicily</button>
              <button class="tag small" onclick="toggleTag(this)">Piedmont</button>
            </div>
            <div class="sub-group-label">Spain:</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Basque</button>
              <button class="tag small" onclick="toggleTag(this)">Catalonia</button>
            </div>
          </div>
        </div>

        <!-- Asian Sub-options -->
        <div id="asian-sub" class="sub-options hidden">
          <div class="sub-section">
            <div class="sub-label">üåè Asian Regions</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Chinese</button>
              <button class="tag small" onclick="toggleTag(this)">Japanese</button>
              <button class="tag small" onclick="toggleTag(this)">Thai</button>
              <button class="tag small" onclick="toggleTag(this)">Vietnamese</button>
              <button class="tag small" onclick="toggleTag(this)">Korean</button>
              <button class="tag small" onclick="toggleTag(this)">Indian</button>
            </div>
          </div>
        </div>

        <!-- Mexican Sub-options -->
        <div id="mexican-sub" class="sub-options hidden">
          <div class="sub-section">
            <div class="sub-label">üá≤üáΩ Mexican Regions</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Oaxaca</button>
              <button class="tag small" onclick="toggleTag(this)">Yucatan</button>
              <button class="tag small" onclick="toggleTag(this)">Mexico City</button>
              <button class="tag small" onclick="toggleTag(this)">Baja</button>
            </div>
          </div>
        </div>

        <!-- Middle Eastern Sub-options -->
        <div id="middleeastern-sub" class="sub-options hidden">
          <div class="sub-section">
            <div class="sub-label">üïå Middle Eastern</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Lebanese</button>
              <button class="tag small" onclick="toggleTag(this)">Persian</button>
              <button class="tag small" onclick="toggleTag(this)">Turkish</button>
              <button class="tag small" onclick="toggleTag(this)">Israeli</button>
              <button class="tag small" onclick="toggleTag(this)">Moroccan</button>
            </div>
          </div>
        </div>

        <!-- Caribbean Sub-options -->
        <div id="caribbean-sub" class="sub-options hidden">
          <div class="sub-section">
            <div class="sub-label">üèùÔ∏è Caribbean</div>
            <div class="tag-group">
              <button class="tag small" onclick="toggleTag(this)">Jamaican</button>
              <button class="tag small" onclick="toggleTag(this)">Cuban</button>
              <button class="tag small" onclick="toggleTag(this)">Puerto Rican</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 class="card-title">ü•ó Dietary Considerations</h2>
        <div class="tag-group" style="margin-bottom: 1rem;">
          <button class="tag" onclick="toggleTag(this)">Vegetarian</button>
          <button class="tag" onclick="toggleTag(this)">Vegan</button>
          <button class="tag" onclick="toggleTag(this)">Gluten-Free</button>
          <button class="tag" onclick="toggleTag(this)">Dairy-Free</button>
          <button class="tag" onclick="toggleTag(this)">Keto</button>
          <button class="tag" onclick="toggleTag(this)">Pescatarian</button>
        </div>
        <div class="form-group">
          <label>Ingredients You Love</label>
          <input type="text" id="lovesInput" placeholder="Beef, mushrooms, garlic, chocolate...">
        </div>
        <div class="form-group">
          <label>Ingredients to Avoid</label>
          <input type="text" id="avoidsInput" placeholder="Cilantro, blue cheese, olives...">
        </div>
        <div class="form-group">
          <label>Allergies / Restrictions</label>
          <input type="text" id="dietaryInput" placeholder="Nut allergy, shellfish allergy...">
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary" onclick="goToStep(2)">‚Üê Back</button>
        <button class="btn btn-primary" onclick="generateMenus()">Generate 5 Menu Options ‚Üí</button>
      </div>
    </div>

    <!-- STEP 4: Choose Menu -->
    <div id="step4" class="hidden">
      <div class="card">
        <h2 class="card-title">üçΩÔ∏è Choose Your Menu</h2>
        <div class="info-box" id="menuInfoBox">Using curated demo menus. Add API key in Settings for AI-generated options.</div>
        <div id="menuOptions"></div>
      </div>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="goToStep(3)">‚Üê Back</button>
        <button class="btn btn-primary" id="toStep5" disabled onclick="goToStep(5)">Choose Staffing ‚Üí</button>
      </div>
    </div>

    <!-- STEP 5: Staffing & Timeline -->
    <div id="step5" class="hidden">
      <div class="card">
        <h2 class="card-title">‚è±Ô∏è Kitchen Team & Timeline</h2>
        <p class="card-subtitle">Choose your staffing level to see time estimates</p>
        <div class="info-box"><strong>Make-Ahead Strategy:</strong> 70% of work done before guests arrive!</div>
        <div id="staffingList"></div>
      </div>
      <div id="timelineModal" class="hidden">
        <div class="card" style="border: 2px solid var(--navy);">
          <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
            <div>
              <h3 class="card-title" id="modalTitle">Timeline</h3>
              <p class="card-subtitle" id="modalSubtitle"></p>
            </div>
            <button class="btn btn-secondary" onclick="closeTimeline()">‚úï</button>
          </div>
          <div id="modalTasks"></div>
          <div class="btn-row">
            <button class="btn btn-secondary" onclick="closeTimeline()">‚Üê Back</button>
            <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è Print</button>
          </div>
        </div>
      </div>
      <div class="btn-row" id="step5Buttons">
        <button class="btn btn-secondary" onclick="goToStep(4)">‚Üê Back</button>
        <button class="btn btn-primary" id="toStep6" disabled onclick="goToStep(6)">Create Cookbook ‚Üí</button>
      </div>
    </div>

    <!-- STEP 6: Download -->
    <div id="step6" class="hidden">
      <div class="card">
        <div class="download-header">
          <div class="icon">üçΩÔ∏è</div>
          <h2 id="finalEventTitle">Your Dinner Party</h2>
          <p id="finalEventDetails">Date ‚Ä¢ Time ‚Ä¢ Guests</p>
          <p id="finalMenuName" style="font-weight: 600; color: var(--navy); margin-top: 0.5rem;"></p>
        </div>
        <h3 class="card-title" style="margin-bottom: 1rem;">üì• Download Your Package</h3>
        <div class="download-grid">
          <button class="download-btn" onclick="downloadDocx()">
            <span class="icon">üìÑ</span>
            <span>Cookbook (DOCX)</span>
          </button>
          <button class="download-btn" onclick="downloadHtml()">
            <span class="icon">üåê</span>
            <span>Web (HTML)</span>
          </button>
          <button class="download-btn" onclick="window.print()">
            <span class="icon">üñ®Ô∏è</span>
            <span>Print / PDF</span>
          </button>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn btn-secondary" onclick="goToStep(5)">‚Üê Back</button>
        <button class="btn btn-secondary" onclick="startOver()">üîÑ Start Over</button>
      </div>
    </div>
  </div>

  <script>
    // Settings
    function toggleSettings() {
      document.getElementById('settingsContent').classList.toggle('hidden');
      document.getElementById('settingsArrow').textContent = document.getElementById('settingsContent').classList.contains('hidden') ? '‚ñº' : '‚ñ≤';
    }

    async function validateCode() {
      const code = document.getElementById('accessCode').value;
      const status = document.getElementById('apiStatus');
      try {
        const res = await fetch('/api/validate-code', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({code}) });
        const data = await res.json();
        if (data.valid) { status.className = 'api-status success'; status.textContent = '‚úì Code validated! AI menus available.'; }
        else { status.className = 'api-status error'; status.textContent = '‚ö†Ô∏è ' + (data.error || 'Invalid code'); }
      } catch(e) { status.className = 'api-status error'; status.textContent = '‚ö†Ô∏è Connection error'; }
    }

    // Data
    const STAFFING = [
      { id: 'solo', name: 'Solo Cook', icon: 'üë®‚Äçüç≥', desc: 'All tasks yours ‚Äî maximum prep ahead', activeMin: 185 },
      { id: 'helper1', name: 'With 1 Helper', icon: 'üë•', desc: 'You handle technique, helper preps & plates', activeMin: 95 },
      { id: 'helper2', name: 'With 2 Helpers', icon: 'üë•üë§', desc: 'Full team ‚Äî parallel workflows', activeMin: 65 },
      { id: 'chef', name: 'Hired Chef', icon: '‚≠ê', desc: 'You host only ‚Äî stay out of kitchen!', activeMin: 25 }
    ];

    const DEMO_MENUS = [
      { title: "Modern European Steakhouse", foodCost: "$55-65/person", wineCost: "$150", courses: [
        { type: "Amuse-Bouche", name: "Steak Tartare on Crispy Potato Rounds with Dijon Aioli" },
        { type: "First Course", name: "Roasted Beet & Goat Cheese Salad with Candied Walnuts" },
        { type: "Second Course", name: "Wild Mushroom Bisque with White Truffle Oil" },
        { type: "Main Course", name: "Pan-Seared Filet Mignon with Red Wine Reduction" },
        { type: "Dessert", name: "Molten Chocolate Lava Cake with Vanilla Bean Ice Cream" }
      ]},
      { title: "Elegant Seafood Soir√©e", foodCost: "$50-60/person", wineCost: "$130", courses: [
        { type: "Amuse-Bouche", name: "Smoked Salmon on Cucumber Rounds with Cr√®me Fra√Æche" },
        { type: "First Course", name: "Classic Lobster Bisque with Cognac Cream" },
        { type: "Second Course", name: "Baby Spinach Salad with Warm Bacon Vinaigrette" },
        { type: "Main Course", name: "Pan-Seared Scallops with Cauliflower Pur√©e" },
        { type: "Dessert", name: "Classic Lemon Tart with Raspberry Coulis" }
      ]},
      { title: "Mediterranean Garden Party", foodCost: "$45-55/person", wineCost: "$120", courses: [
        { type: "Amuse-Bouche", name: "Marinated Olives & Manchego with Honey Drizzle" },
        { type: "First Course", name: "Grilled Halloumi with Fig Jam & Arugula" },
        { type: "Second Course", name: "Greek Salad with Creamy Feta Dressing" },
        { type: "Main Course", name: "Herb-Crusted Lamb Chops with Roasted Vegetables" },
        { type: "Dessert", name: "Honey Baklava with Pistachio Ice Cream" }
      ]},
      { title: "Asian Fusion Experience", foodCost: "$55-65/person", wineCost: "$140", courses: [
        { type: "Amuse-Bouche", name: "Tuna Tartare on Wonton Crisps with Wasabi Cream" },
        { type: "First Course", name: "Miso Soup with Silken Tofu & Wakame" },
        { type: "Second Course", name: "Seaweed Salad with Sesame Dressing" },
        { type: "Main Course", name: "Miso-Glazed Black Cod with Bok Choy" },
        { type: "Dessert", name: "Matcha Panna Cotta with Red Bean & Mochi" }
      ]},
      { title: "Classic French Bistro", foodCost: "$50-60/person", wineCost: "$135", courses: [
        { type: "Amuse-Bouche", name: "Goug√®res (Warm Cheese Puffs)" },
        { type: "First Course", name: "Soupe √† l'Oignon Gratin√©e" },
        { type: "Second Course", name: "Salade Lyonnaise with Fris√©e & Lardons" },
        { type: "Main Course", name: "Coq au Vin with Buttered Egg Noodles" },
        { type: "Dessert", name: "Tarte Tatin with Cr√®me Fra√Æche" }
      ]}
    ];

    // State
    let currentStep = 1;
    let selectedStyle = 'classic';
    let selectedInspiration = null;
    let selectedBudget = 'moderate';
    let selectedSkill = 'intermediate';
    let selectedMenuIndex = null;
    let selectedStaffing = null;

    // Navigation
    function goToStep(step) {
      for (let i = 1; i <= 6; i++) {
        const el = document.getElementById('step' + i);
        if (el) el.classList.add('hidden');
      }
      document.getElementById('step' + step).classList.remove('hidden');

      for (let i = 1; i <= 6; i++) {
        const dot = document.getElementById('pstep' + i);
        const line = document.getElementById('pline' + i);
        if (dot) {
          dot.classList.remove('active', 'complete');
          if (i < step) dot.classList.add('complete');
          else if (i === step) dot.classList.add('active');
        }
        if (line) line.classList.toggle('complete', i < step);
      }

      currentStep = step;
      if (step === 4) renderMenuOptions();
      if (step === 5) renderStaffingList();
      if (step === 6) updateFinalDetails();
      window.scrollTo(0, 0);
    }

    // Selections
    function selectStyle(el) {
      document.querySelectorAll('.style-card').forEach(c => c.classList.remove('selected'));
      el.classList.add('selected');
      selectedStyle = el.dataset.style;
    }

    function selectInspiration(el) {
      document.querySelectorAll('.inspiration-card').forEach(c => c.classList.remove('selected'));
      el.classList.add('selected');
      selectedInspiration = el.dataset.inspiration;
    }

    function selectOption(el, group) {
      el.parentElement.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
      el.classList.add('selected');
      if (group === 'budget') selectedBudget = el.dataset.value;
      if (group === 'skill') selectedSkill = el.dataset.value;
    }

    function toggleTag(el) {
      el.classList.toggle('selected');
    }

    function toggleCuisine(el, id) {
      el.classList.toggle('selected');
      const sub = document.getElementById(id + '-sub');
      if (sub) {
        if (el.classList.contains('selected')) sub.classList.remove('hidden');
        else {
          sub.classList.add('hidden');
          sub.querySelectorAll('.tag.selected').forEach(t => t.classList.remove('selected'));
        }
      }
    }

    function selectMenu(index) {
      document.querySelectorAll('.menu-option').forEach((m, i) => m.classList.toggle('selected', i === index));
      selectedMenuIndex = index;
      document.getElementById('toStep5').disabled = false;
    }

    // Menu Generation
    function generateMenus() {
      goToStep(4);
    }

    function renderMenuOptions() {
      const container = document.getElementById('menuOptions');
      container.innerHTML = '';
      DEMO_MENUS.forEach((menu, index) => {
        const div = document.createElement('div');
        div.className = 'menu-option';
        div.onclick = () => selectMenu(index);
        div.innerHTML = `
          <h3>Option ${index + 1}: ${menu.title}</h3>
          <div class="estimate">Estimated: ${menu.foodCost} ‚Ä¢ ${menu.wineCost} (Wine)</div>
          ${menu.courses.map(c => `<div class="course"><strong>${c.type}:</strong> ${c.name}</div>`).join('')}
        `;
        container.appendChild(div);
      });
    }

    // Staffing
    function renderStaffingList() {
      const container = document.getElementById('staffingList');
      container.innerHTML = '';
      STAFFING.forEach(s => {
        const div = document.createElement('div');
        div.className = 'staffing-card' + (selectedStaffing === s.id ? ' selected' : '');
        div.innerHTML = `
          <div class="staffing-header">
            <div class="staffing-info">
              <span class="staffing-icon">${s.icon}</span>
              <div>
                <div class="staffing-name">${s.name}</div>
                <div class="staffing-desc">${s.desc}</div>
              </div>
            </div>
            <div class="staffing-stats">
              <strong>~${s.activeMin} min</strong>
              <span>your time</span>
            </div>
          </div>
          <div class="staffing-buttons">
            <button class="staffing-btn view" onclick="viewTimeline('${s.id}')">üëÅÔ∏è View Timeline</button>
            <button class="staffing-btn select ${selectedStaffing === s.id ? 'selected' : ''}" onclick="selectStaffing('${s.id}')">${selectedStaffing === s.id ? '‚úì Selected' : 'Select'}</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function selectStaffing(id) {
      selectedStaffing = id;
      renderStaffingList();
      document.getElementById('toStep6').disabled = false;
    }

    function viewTimeline(id) {
      const staff = STAFFING.find(s => s.id === id);
      document.getElementById('modalTitle').innerHTML = staff.icon + ' ' + staff.name;
      document.getElementById('modalSubtitle').textContent = staff.desc + ' ‚Ä¢ ~' + staff.activeMin + ' min active time';
      document.getElementById('modalTasks').innerHTML = `
        <div style="padding: 1rem; background: #f8f5f0; border-radius: 8px;">
          <p><strong>Day Before:</strong> Make soup base (25 min), Marinate protein (15 min), Prep vegetables (30 min), Make sauces (20 min)</p>
          <p style="margin-top: 0.75rem;"><strong>Day Of:</strong> 4 hrs before: Final prep ‚Ä¢ 2 hrs: Start cooking ‚Ä¢ 1 hr: Sear proteins ‚Ä¢ 30 min: Finish dishes ‚Ä¢ Service: Plate & serve</p>
        </div>
      `;
      document.getElementById('staffingList').classList.add('hidden');
      document.getElementById('step5Buttons').classList.add('hidden');
      document.getElementById('timelineModal').classList.remove('hidden');
    }

    function closeTimeline() {
      document.getElementById('timelineModal').classList.add('hidden');
      document.getElementById('staffingList').classList.remove('hidden');
      document.getElementById('step5Buttons').classList.remove('hidden');
    }

    // Final Details
    function updateFinalDetails() {
      const title = document.getElementById('eventTitle').value || 'Your Dinner Party';
      const date = document.getElementById('eventDate').value;
      const time = document.getElementById('eventTime').value;
      const guests = document.getElementById('guestCount').value;
      const dateStr = date ? new Date(date + 'T00:00').toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) : 'Date TBD';
      const timeStr = time ? new Date('2000-01-01T' + time).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }) : '';

      document.getElementById('finalEventTitle').textContent = title;
      document.getElementById('finalEventDetails').textContent = dateStr + ' at ' + timeStr + ' ‚Ä¢ ' + guests + ' Guests';

      if (selectedMenuIndex !== null) {
        document.getElementById('finalMenuName').textContent = DEMO_MENUS[selectedMenuIndex].title;
      }
      if (selectedStaffing) {
        const staff = STAFFING.find(s => s.id === selectedStaffing);
        document.getElementById('finalMenuName').textContent += ' ‚Ä¢ ' + staff.name;
      }
    }

    // Downloads
    async function downloadDocx() {
      const eventDetails = {
        title: document.getElementById('eventTitle').value || 'Dinner Party',
        date: document.getElementById('eventDate').value,
        time: document.getElementById('eventTime').value,
        guests: document.getElementById('guestCount').value
      };
      const menu = selectedMenuIndex !== null ? DEMO_MENUS[selectedMenuIndex] : DEMO_MENUS[0];

      try {
        const res = await fetch('/api/generate-docx', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ eventDetails, selectedMenu: menu, staffingId: selectedStaffing })
        });
        if (res.ok) {
          const blob = await res.blob();
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = (eventDetails.title.replace(/[^a-z0-9]/gi, '_') || 'Cookbook') + '_Cookbook.docx';
          a.click();
          URL.revokeObjectURL(url);
        } else {
          alert('Error generating cookbook. Please try again.');
        }
      } catch(e) {
        alert('Error: ' + e.message);
      }
    }

    function downloadHtml() {
      const eventTitle = document.getElementById('eventTitle').value || 'Dinner Party';
      const eventDate = document.getElementById('eventDate').value;
      const eventTime = document.getElementById('eventTime').value;
      const guestCount = document.getElementById('guestCount').value || 6;
      const menu = selectedMenuIndex !== null ? DEMO_MENUS[selectedMenuIndex] : DEMO_MENUS[0];
      const staff = STAFFING.find(s => s.id === selectedStaffing) || STAFFING[0];

      const dateStr = eventDate ? new Date(eventDate + 'T00:00').toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) : 'Date TBD';
      const timeStr = eventTime || '7:00 PM';

      const html = `<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>${eventTitle} - Cookbook</title>
<style>
body{font-family:Georgia,serif;max-width:800px;margin:0 auto;padding:2rem;color:#2d3a35;line-height:1.6}
h1{color:#1e3a5f;font-size:2.5rem;text-align:center;margin-bottom:0.5rem}
h2{color:#1e3a5f;font-size:1.5rem;margin:2rem 0 1rem;padding-bottom:0.5rem;border-bottom:2px solid #c9a227}
h3{color:#2d6a4f;font-size:1.2rem;margin:1.5rem 0 0.75rem}
.subtitle{text-align:center;color:#6b7c85;font-style:italic;margin-bottom:2rem}
.course{margin-bottom:1rem}
.course-type{color:#c9a227;font-weight:bold;text-transform:uppercase;font-size:0.8rem}
.course-name{font-size:1.1rem;margin-left:1rem}
.checklist{list-style:none;padding:0}
.checklist li{padding:0.5rem 0}
.checklist li::before{content:"‚òê "}
.tip-box{background:#fff9e6;border-left:4px solid #c9a227;padding:1rem;margin:1rem 0}
.timeline-block{background:#f0f4f8;padding:0.75rem 1rem;margin:0.5rem 0;border-radius:4px}
@media print{body{padding:0}h2{page-break-before:always}}
</style></head><body>
<h1>üçΩÔ∏è ${eventTitle}</h1>
<p class="subtitle">${dateStr} at ${timeStr} ‚Ä¢ ${guestCount} Guests<br>${menu.title} ‚Ä¢ ${staff.name}</p>

<h2>The Menu</h2>
${menu.courses.map(c => `<div class="course"><span class="course-type">${c.type}</span><div class="course-name">${c.name}</div></div>`).join('')}

<h2>Wine Pairings</h2>
<p>Wine budget: ${menu.wineCost}</p>
<ul>
<li><strong>Amuse-Bouche:</strong> Champagne or Cr√©mant</li>
<li><strong>First Course:</strong> Sancerre or Sauvignon Blanc</li>
<li><strong>Second Course:</strong> Chablis or Chardonnay</li>
<li><strong>Main Course:</strong> C√¥tes du Rh√¥ne or Pinot Noir</li>
<li><strong>Dessert:</strong> Sauternes or Late Harvest</li>
</ul>

<h2>Shopping List</h2>
<p>Scaled for ${guestCount} guests</p>
<h3>Proteins</h3>
<ul class="checklist"><li>Main protein</li><li>Seafood for courses</li><li>Butter (2 lbs)</li></ul>
<h3>Produce</h3>
<ul class="checklist"><li>Mixed greens (1 lb)</li><li>Seasonal vegetables</li><li>Fresh herbs</li><li>Lemons (6)</li></ul>
<h3>Dairy</h3>
<ul class="checklist"><li>Heavy cream (1 qt)</li><li>Cr√®me fra√Æche (8 oz)</li><li>Parmesan (4 oz)</li><li>Eggs (1 dozen)</li></ul>

<h2>Day-Before Prep</h2>
<ul class="checklist">
<li>Make soup/bisque base (25 min)</li>
<li>Marinate protein (15 min)</li>
<li>Prep all vegetables (30 min)</li>
<li>Make pur√©es/sauces (20 min)</li>
<li>Set out serving dishes (10 min)</li>
</ul>
<div class="tip-box"><strong>üí° Make-Ahead Secret:</strong> Getting 70% of work done before the day-of means you'll enjoy your own party!</div>

<h2>Day-Of Timeline</h2>
<p>Service time: ${timeStr}</p>
<div class="timeline-block"><strong>4 hours before:</strong> Final mise en place, temper proteins</div>
<div class="timeline-block"><strong>3 hours before:</strong> Set table, chill wines, prep garnishes</div>
<div class="timeline-block"><strong>2 hours before:</strong> Start long-cooking items, make sauces</div>
<div class="timeline-block"><strong>1 hour before:</strong> Sear proteins, final vegetable prep</div>
<div class="timeline-block"><strong>30 min before:</strong> Roast/finish main, open red wine, light candles</div>
<div class="timeline-block"><strong>Service:</strong> Plate amuse-bouche, welcome guests!</div>

<h2>Table Settings</h2>
<ul>
<li>Dinner plate centered 1" from edge</li>
<li>Forks left, knife and spoon right</li>
<li>Water glass above knife</li>
<li>Wine glasses to the right</li>
<li>Napkin on plate or left of forks</li>
</ul>

<h2>Final Checklist</h2>
<h3>Kitchen</h3>
<ul class="checklist"><li>All ingredients prepped</li><li>Oven preheated</li><li>Plates warming</li><li>Sauces ready</li></ul>
<h3>Dining Room</h3>
<ul class="checklist"><li>Table set</li><li>Candles ready</li><li>Music queued</li><li>Wine opened</li></ul>

<p style="text-align:center;margin-top:3rem;color:#6b7c85;font-style:italic;">Generated by Dinner Party Planner</p>
</body></html>`;

      const blob = new Blob([html], {type: 'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = eventTitle.replace(/[^a-z0-9]/gi, '_') + '_Cookbook.html';
      a.click();
      URL.revokeObjectURL(url);
    }

    function startOver() {
      selectedMenuIndex = null;
      selectedStaffing = null;
      document.getElementById('toStep5').disabled = true;
      document.getElementById('toStep6').disabled = true;
      goToStep(1);
    }

    // Initialize
    document.getElementById('eventDate').value = new Date().toISOString().split('T')[0];
  </script>
</body>
</html>
